@model SimpleOrderSystem.Domain.Enums.OrderStatus
@using SimpleOrderSystem.Domain.Enums
@using SimpleOrderSystem.Domain.Entities
@using SimpleOrderSystem.Web.Extensions

@{
    var steps = new[]
    {
        OrderStatus.Pending,
        OrderStatus.Paid,
        OrderStatus.Processing,
        OrderStatus.Shipped,
        OrderStatus.Completed
    };

    // Optional audit history (passed via ViewData)
    var audits = ViewData["Audits"] as IReadOnlyCollection<OrderStatusAudit>;
}

<!-- STATUS PROGRESSION -->
<div class="d-flex justify-content-between align-items-center my-2">
    @foreach (var step in steps)
    {
        var active = step <= Model;

        <div class="text-center flex-fill">
            <div class="badge rounded-pill @(active? step.ToBadgeClass() : "bg-light text-muted")">
                @step
            </div>
        </div>
    }
</div>

<!-- STATUS AUDIT HISTORY (ADMIN ONLY / OPTIONAL) -->
@if (audits != null && audits.Any())
{
    <div class="mt-3">
        <h6 class="text-muted">Status History</h6>

        <ul class="list-group list-group-flush">
            @foreach (var audit in audits.OrderByDescending(a => a.ChangedAt))
            {
                <li class="list-group-item px-0">
                    <strong>@audit.ChangedBy</strong>
                    changed status from
                    <span class="badge bg-secondary">@audit.OldStatus</span>
                    →
                    <span class="badge bg-primary">@audit.NewStatus</span>
                    <br />
                    <small class="text-muted">
                        @audit.ChangedAt.ToLocalTime()
                    </small>
                </li>
            }
        </ul>
    </div>
}
